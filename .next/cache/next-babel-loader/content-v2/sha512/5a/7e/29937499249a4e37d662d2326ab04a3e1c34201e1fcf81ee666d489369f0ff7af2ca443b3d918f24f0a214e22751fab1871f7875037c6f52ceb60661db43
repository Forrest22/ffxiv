{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React, { useState, useEffect } from 'react';\nimport { useQueryState } from 'next-usequerystate';\nimport { makeStyles } from '@material-ui/core/styles';\nimport NoSsr from '@material-ui/core/NoSsr';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport TextField from '@material-ui/core/TextField';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport Select from '@material-ui/core/Select';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Section from '../Section';\nimport UpcomingVoyagesTable from './UpcomingVoyagesTable';\nimport { fishingSpots, fishes, achievements } from './ffxiv-ocean-fishing/data';\nimport { calculateVoyages, calculateVoyagesOld } from './ffxiv-ocean-fishing';\nimport * as maps from './maps';\nimport { upperFirst } from './utils';\nimport translate from '../translate';\nimport { useTranslation } from '../i18n';\nconst useStyles = makeStyles(theme => ({\n  listSubheader: {\n    paddingTop: theme.spacing(2)\n  },\n  useOld: {\n    display: 'block',\n    [theme.breakpoints.up('md')]: {\n      textAlign: 'right'\n    }\n  },\n  checkbox: {\n    padding: 0,\n    margin: theme.spacing(0, 1)\n  }\n}));\n\nfunction getFilter(filter) {\n  if (filter === null) {\n    return undefined;\n  } else if (maps.FILTER_MAP[filter]) {\n    return maps.FILTER_MAP[filter];\n  } else {\n    return filter.split(',').filter(destTime => destTime.length === 2 && 'BNRT'.includes(destTime[0]) && 'DSN'.includes(destTime[1]));\n  }\n}\n\nconst UpcomingVoyages = ({\n  now,\n  onSelectRoute\n}) => {\n  const classes = useStyles();\n  const {\n    t,\n    i18n\n  } = useTranslation('ocean-fishing');\n  const {\n    0: numRows,\n    1: setNumRows\n  } = useState(10);\n  const [useOld, setUseOld] = useQueryState('old', {\n    parse: query => query === 'true' ? true : null\n  });\n  const [filter, setFilter] = useQueryState('filter');\n\n  const _filter = getFilter(filter);\n\n  const isCustomFilter = filter !== null && maps.FILTER_MAP[filter] === undefined;\n  const calculate = useOld ? calculateVoyagesOld : calculateVoyages;\n  const locale = i18n.language;\n  useEffect(() => {\n    onSelectRoute(calculate(now, 1, _filter && _filter.length > 0 ? _filter : undefined)[0].destTime);\n  }, [filter]);\n\n  const handleToggleUseOld = () => {\n    setUseOld(useOld === true ? null : true);\n  };\n\n  const handleInputNumRows = event => {\n    setNumRows(Number(event.target.value));\n  };\n\n  const handleBlurNumRows = event => {\n    const numRows = Number(event.target.value);\n\n    if (!isFinite(numRows)) {\n      setNumRows(10);\n    } else {\n      setNumRows(Math.min(Math.max(Math.floor(numRows), 1), 50));\n    }\n  };\n\n  const handleSelectFilter = event => {\n    const filter = event.target.value === 'none' ? null : event.target.value;\n    setFilter(filter);\n  };\n\n  return /*#__PURE__*/_jsx(Section, {\n    title: /*#__PURE__*/_jsxs(Grid, {\n      container: true,\n      alignItems: \"flex-end\",\n      children: [/*#__PURE__*/_jsx(Grid, {\n        item: true,\n        xs: 12,\n        md: 8,\n        children: t('upcomingVoyages')\n      }), /*#__PURE__*/_jsx(Grid, {\n        item: true,\n        xs: 12,\n        md: 4,\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: classes.useOld,\n          children: /*#__PURE__*/_jsx(NoSsr, {\n            children: /*#__PURE__*/_jsx(Tooltip, {\n              placement: \"top\",\n              title: /*#__PURE__*/_jsx(Typography, {\n                children: \"Select this for clients without the newest routes yet (KO clients)\"\n              }),\n              children: /*#__PURE__*/_jsx(FormControlLabel, {\n                control: /*#__PURE__*/_jsx(Checkbox, {\n                  checked: useOld === true,\n                  onChange: handleToggleUseOld,\n                  className: classes.checkbox\n                }),\n                label: \"Use old routes\"\n              })\n            })\n          })\n        })\n      })]\n    }),\n    children: /*#__PURE__*/_jsxs(Grid, {\n      container: true,\n      spacing: 2,\n      children: [/*#__PURE__*/_jsx(Grid, {\n        item: true,\n        xs: 12,\n        sm: 6,\n        children: /*#__PURE__*/_jsx(FormControl, {\n          fullWidth: true,\n          children: /*#__PURE__*/_jsx(TextField, {\n            variant: \"filled\",\n            label: t('numberOfRows'),\n            type: \"number\",\n            value: numRows,\n            onChange: handleInputNumRows,\n            onBlur: handleBlurNumRows\n          })\n        })\n      }), /*#__PURE__*/_jsx(Grid, {\n        item: true,\n        xs: 12,\n        sm: 6,\n        children: /*#__PURE__*/_jsxs(FormControl, {\n          fullWidth: true,\n          variant: \"filled\",\n          children: [/*#__PURE__*/_jsx(InputLabel, {\n            children: t('filterRoute')\n          }), /*#__PURE__*/_jsx(NoSsr, {\n            children: /*#__PURE__*/_jsxs(Select, {\n              value: filter !== null ? isCustomFilter ? 'custom' : filter : 'none',\n              onChange: handleSelectFilter,\n              children: [/*#__PURE__*/_jsx(MenuItem, {\n                value: \"none\",\n                children: t('noFilter')\n              }), isCustomFilter && /*#__PURE__*/_jsx(MenuItem, {\n                value: \"custom\",\n                disabled: true,\n                children: /*#__PURE__*/_jsx(\"i\", {\n                  children: \"Custom Filter\"\n                })\n              }), /*#__PURE__*/_jsx(ListSubheader, {\n                disableSticky: true,\n                className: classes.listSubheader,\n                children: t('blueFish')\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"sothis\",\n                children: translate(locale, fishes[29788], 'name')\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"coral_manta\",\n                children: translate(locale, fishes[29789], 'name')\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"stonescale\",\n                children: translate(locale, fishes[29790], 'name')\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"elasmosaurus\",\n                children: translate(locale, fishes[29791], 'name')\n              }), useOld === null && [/*#__PURE__*/_jsx(MenuItem, {\n                value: \"hafgufa\",\n                children: translate(locale, fishes[32074], 'name')\n              }, 'hafgufa'), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"seafaring_toad\",\n                children: translate(locale, fishes[32094], 'name')\n              }, 'seafaring_toad'), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"placodus\",\n                children: translate(locale, fishes[32114], 'name')\n              }, 'placodus')], /*#__PURE__*/_jsx(ListSubheader, {\n                disableSticky: true,\n                className: classes.listSubheader,\n                children: t('achievements')\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"octopodes\",\n                children: translate(locale, achievements[2563], 'name')\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"sharks\",\n                children: translate(locale, achievements[2564], 'name')\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"jellyfish\",\n                children: translate(locale, achievements[2565], 'name')\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"seadragons\",\n                children: translate(locale, achievements[2566], 'name')\n              }), useOld === null && [/*#__PURE__*/_jsx(MenuItem, {\n                value: \"balloons\",\n                children: translate(locale, achievements[2754], 'name')\n              }, 'balloons'), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"crabs\",\n                children: translate(locale, achievements[2755], 'name')\n              }, 'crabs'), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"mantas\",\n                children: translate(locale, achievements[2756], 'name')\n              }, 'mantas')], /*#__PURE__*/_jsx(ListSubheader, {\n                disableSticky: true,\n                className: classes.listSubheader,\n                children: upperFirst(translate(locale, fishingSpots[241].placeName_sub, 'name_noArticle', 'name'))\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"R\",\n                children: upperFirst(translate(locale, fishingSpots[241].placeName_sub, 'name_noArticle', 'name'))\n              }), /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"RD\",\n                children: [upperFirst(translate(locale, fishingSpots[241].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.day')]\n              }), /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"RS\",\n                children: [upperFirst(translate(locale, fishingSpots[241].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.sunset')]\n              }), /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"RN\",\n                children: [upperFirst(translate(locale, fishingSpots[241].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.night')]\n              }), /*#__PURE__*/_jsx(ListSubheader, {\n                disableSticky: true,\n                className: classes.listSubheader,\n                children: upperFirst(translate(locale, fishingSpots[243].placeName_sub, 'name_noArticle', 'name'))\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"N\",\n                children: upperFirst(translate(locale, fishingSpots[243].placeName_sub, 'name_noArticle', 'name'))\n              }), /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"ND\",\n                children: [upperFirst(translate(locale, fishingSpots[243].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.day')]\n              }), /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"NS\",\n                children: [upperFirst(translate(locale, fishingSpots[243].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.sunset')]\n              }), /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"NN\",\n                children: [upperFirst(translate(locale, fishingSpots[243].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.night')]\n              }), useOld === null && [/*#__PURE__*/_jsx(ListSubheader, {\n                disableSticky: true,\n                className: classes.listSubheader,\n                children: upperFirst(translate(locale, fishingSpots[248].placeName_sub, 'name_noArticle', 'name'))\n              }, '1'), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"B\",\n                children: upperFirst(translate(locale, fishingSpots[248].placeName_sub, 'name_noArticle', 'name'))\n              }, 'B'), /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"BD\",\n                children: [upperFirst(translate(locale, fishingSpots[248].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.day')]\n              }, 'BD'), /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"BS\",\n                children: [upperFirst(translate(locale, fishingSpots[248].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.sunset')]\n              }, 'BS'), /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"BN\",\n                children: [upperFirst(translate(locale, fishingSpots[248].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.night')]\n              }, 'BN'), /*#__PURE__*/_jsx(ListSubheader, {\n                disableSticky: true,\n                className: classes.listSubheader,\n                children: upperFirst(translate(locale, fishingSpots[250].placeName_sub, 'name_noArticle', 'name'))\n              }, '2'), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"T\",\n                children: upperFirst(translate(locale, fishingSpots[250].placeName_sub, 'name_noArticle', 'name'))\n              }, 'T'), /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"TD\",\n                children: [upperFirst(translate(locale, fishingSpots[250].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.day')]\n              }, 'TD'), /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"TS\",\n                children: [upperFirst(translate(locale, fishingSpots[250].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.sunset')]\n              }, 'TS'), /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"TN\",\n                children: [upperFirst(translate(locale, fishingSpots[250].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.night')]\n              }, 'TN')]]\n            })\n          })]\n        })\n      }), /*#__PURE__*/_jsx(Grid, {\n        item: true,\n        xs: 12,\n        children: /*#__PURE__*/_jsx(NoSsr, {\n          children: /*#__PURE__*/_jsx(UpcomingVoyagesTable, {\n            now: now,\n            numRows: numRows,\n            useOld: useOld === true,\n            filter: _filter,\n            onSelectRoute: onSelectRoute\n          })\n        })\n      })]\n    })\n  });\n};\n\nexport default UpcomingVoyages;","map":null,"metadata":{},"sourceType":"module"}