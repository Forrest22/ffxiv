{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _slicedToArray from \"/root/ffxiv/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"/root/ffxiv/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport React, { useState, useEffect } from 'react';\nimport { useQueryState } from 'next-usequerystate';\nimport { makeStyles } from '@material-ui/core/styles';\nimport NoSsr from '@material-ui/core/NoSsr';\nimport Grid from '@material-ui/core/Grid';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport TextField from '@material-ui/core/TextField';\nimport Select from '@material-ui/core/Select';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Section from '../Section';\nimport UpcomingVoyagesTable from './UpcomingVoyagesTable';\nimport { fishingSpots, fishes, achievements } from './ffxiv-ocean-fishing/data';\nimport { calculateVoyages } from './ffxiv-ocean-fishing';\nimport * as maps from './maps';\nimport { upperFirst, isUncaughtRoute } from './utils';\nimport translate from '../translate';\nimport { useTranslation } from '../i18n';\nvar useStyles = makeStyles(function (theme) {\n  return {\n    listSubheader: {\n      paddingTop: theme.spacing(2)\n    },\n    useOld: _defineProperty({\n      display: 'block'\n    }, theme.breakpoints.up('md'), {\n      textAlign: 'right'\n    }),\n    checkbox: {\n      padding: 0,\n      margin: theme.spacing(0, 1)\n    }\n  };\n}); // `filter` is one of\n//  - `null` for no filter\n//  - a key in maps.FILTER_MAP for some predefined filter\n//  - 'uncaught' for a dynamic filter for uncaught fish\n//  - comma separated list of DestTimes\n\nfunction getFilter(filter, checklist) {\n  if (filter === null) {\n    return undefined;\n  } else if (maps.FILTER_MAP[filter]) {\n    return maps.FILTER_MAP[filter];\n  } else if (filter === 'uncaught') {\n    return ['BD', 'BS', 'BN', 'ND', 'NS', 'NN', 'RD', 'RS', 'RN', 'TD', 'TS', 'TN'].filter(function (destTime) {\n      return isUncaughtRoute(destTime, checklist !== null && checklist !== void 0 ? checklist : []);\n    });\n  } else {\n    return filter.split(',').filter(function (destTime) {\n      return destTime.length === 2 && 'BNRT'.includes(destTime[0]) && 'DSN'.includes(destTime[1]);\n    });\n  }\n}\n\nvar UpcomingVoyages = function UpcomingVoyages(_ref) {\n  var now = _ref.now,\n      onSelectRoute = _ref.onSelectRoute,\n      checklist = _ref.checklist;\n  var classes = useStyles();\n\n  var _useTranslation = useTranslation('ocean-fishing'),\n      t = _useTranslation.t,\n      i18n = _useTranslation.i18n;\n\n  var _useState = useState(10),\n      numRows = _useState[0],\n      setNumRows = _useState[1];\n\n  var _useQueryState = useQueryState('filter'),\n      _useQueryState2 = _slicedToArray(_useQueryState, 2),\n      filter = _useQueryState2[0],\n      setFilter = _useQueryState2[1];\n\n  var _filter = getFilter(filter, checklist);\n\n  var isCustomFilter = filter !== null && filter !== 'uncaught' && maps.FILTER_MAP[filter] === undefined;\n  var locale = i18n.language;\n  useEffect(function () {\n    onSelectRoute(calculateVoyages(now, 1, _filter && _filter.length > 0 ? _filter : undefined)[0].destTime);\n  }, [filter]);\n\n  var handleInputNumRows = function handleInputNumRows(event) {\n    setNumRows(Number(event.target.value));\n  };\n\n  var handleBlurNumRows = function handleBlurNumRows(event) {\n    var numRows = Number(event.target.value);\n\n    if (!isFinite(numRows)) {\n      setNumRows(10);\n    } else {\n      setNumRows(Math.min(Math.max(Math.floor(numRows), 1), 50));\n    }\n  };\n\n  var handleSelectFilter = function handleSelectFilter(event) {\n    var filter = event.target.value === 'none' ? null : event.target.value;\n    setFilter(filter);\n  };\n\n  return /*#__PURE__*/_jsx(Section, {\n    title: t('upcomingVoyages'),\n    children: /*#__PURE__*/_jsxs(Grid, {\n      container: true,\n      spacing: 2,\n      children: [/*#__PURE__*/_jsx(Grid, {\n        item: true,\n        xs: 12,\n        sm: 6,\n        children: /*#__PURE__*/_jsx(FormControl, {\n          fullWidth: true,\n          children: /*#__PURE__*/_jsx(TextField, {\n            variant: \"filled\",\n            label: t('numberOfRows'),\n            type: \"number\",\n            value: numRows,\n            onChange: handleInputNumRows,\n            onBlur: handleBlurNumRows\n          })\n        })\n      }), /*#__PURE__*/_jsx(Grid, {\n        item: true,\n        xs: 12,\n        sm: 6,\n        children: /*#__PURE__*/_jsxs(FormControl, {\n          fullWidth: true,\n          variant: \"filled\",\n          children: [/*#__PURE__*/_jsx(InputLabel, {\n            children: t('filterRoute')\n          }), /*#__PURE__*/_jsx(NoSsr, {\n            children: /*#__PURE__*/_jsxs(Select, {\n              value: filter !== null ? isCustomFilter ? 'custom' : filter : 'none',\n              onChange: handleSelectFilter,\n              children: [/*#__PURE__*/_jsx(MenuItem, {\n                value: \"none\",\n                children: t('noFilter')\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"uncaught\",\n                children: \"Uncaught Fish\"\n              }), isCustomFilter && /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"custom\",\n                disabled: true,\n                children: [\"Custom Filter: \", _filter && _filter.length > 0 ? _filter.join(', ') : '(none)']\n              }), /*#__PURE__*/_jsx(ListSubheader, {\n                disableSticky: true,\n                className: classes.listSubheader,\n                children: t('blueFish')\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"sothis\",\n                children: translate(locale, fishes[29788], 'name')\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"coral_manta\",\n                children: translate(locale, fishes[29789], 'name')\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"stonescale\",\n                children: translate(locale, fishes[29790], 'name')\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"elasmosaurus\",\n                children: translate(locale, fishes[29791], 'name')\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"hafgufa\",\n                children: translate(locale, fishes[32074], 'name')\n              }), \",\", /*#__PURE__*/_jsx(MenuItem, {\n                value: \"seafaring_toad\",\n                children: translate(locale, fishes[32094], 'name')\n              }), \",\", /*#__PURE__*/_jsx(MenuItem, {\n                value: \"placodus\",\n                children: translate(locale, fishes[32114], 'name')\n              }), /*#__PURE__*/_jsx(ListSubheader, {\n                disableSticky: true,\n                className: classes.listSubheader,\n                children: t('achievements')\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"octopodes\",\n                children: translate(locale, achievements[2563], 'name')\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"sharks\",\n                children: translate(locale, achievements[2564], 'name')\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"jellyfish\",\n                children: translate(locale, achievements[2565], 'name')\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"seadragons\",\n                children: translate(locale, achievements[2566], 'name')\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"balloons\",\n                children: translate(locale, achievements[2754], 'name')\n              }), \",\", /*#__PURE__*/_jsx(MenuItem, {\n                value: \"crabs\",\n                children: translate(locale, achievements[2755], 'name')\n              }), \",\", /*#__PURE__*/_jsx(MenuItem, {\n                value: \"mantas\",\n                children: translate(locale, achievements[2756], 'name')\n              }), /*#__PURE__*/_jsx(ListSubheader, {\n                disableSticky: true,\n                className: classes.listSubheader,\n                children: upperFirst(translate(locale, fishingSpots[241].placeName_sub, 'name_noArticle', 'name'))\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"R\",\n                children: upperFirst(translate(locale, fishingSpots[241].placeName_sub, 'name_noArticle', 'name'))\n              }), /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"RD\",\n                children: [upperFirst(translate(locale, fishingSpots[241].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.day')]\n              }), /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"RS\",\n                children: [upperFirst(translate(locale, fishingSpots[241].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.sunset')]\n              }), /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"RN\",\n                children: [upperFirst(translate(locale, fishingSpots[241].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.night')]\n              }), /*#__PURE__*/_jsx(ListSubheader, {\n                disableSticky: true,\n                className: classes.listSubheader,\n                children: upperFirst(translate(locale, fishingSpots[243].placeName_sub, 'name_noArticle', 'name'))\n              }), /*#__PURE__*/_jsx(MenuItem, {\n                value: \"N\",\n                children: upperFirst(translate(locale, fishingSpots[243].placeName_sub, 'name_noArticle', 'name'))\n              }), /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"ND\",\n                children: [upperFirst(translate(locale, fishingSpots[243].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.day')]\n              }), /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"NS\",\n                children: [upperFirst(translate(locale, fishingSpots[243].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.sunset')]\n              }), /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"NN\",\n                children: [upperFirst(translate(locale, fishingSpots[243].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.night')]\n              }), /*#__PURE__*/_jsx(ListSubheader, {\n                disableSticky: true,\n                className: classes.listSubheader,\n                children: upperFirst(translate(locale, fishingSpots[248].placeName_sub, 'name_noArticle', 'name'))\n              }), \",\", /*#__PURE__*/_jsx(MenuItem, {\n                value: \"B\",\n                children: upperFirst(translate(locale, fishingSpots[248].placeName_sub, 'name_noArticle', 'name'))\n              }), \",\", /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"BD\",\n                children: [upperFirst(translate(locale, fishingSpots[248].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.day')]\n              }), \",\", /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"BS\",\n                children: [upperFirst(translate(locale, fishingSpots[248].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.sunset')]\n              }), \",\", /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"BN\",\n                children: [upperFirst(translate(locale, fishingSpots[248].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.night')]\n              }), \",\", /*#__PURE__*/_jsx(ListSubheader, {\n                disableSticky: true,\n                className: classes.listSubheader,\n                children: upperFirst(translate(locale, fishingSpots[250].placeName_sub, 'name_noArticle', 'name'))\n              }), \",\", /*#__PURE__*/_jsx(MenuItem, {\n                value: \"T\",\n                children: upperFirst(translate(locale, fishingSpots[250].placeName_sub, 'name_noArticle', 'name'))\n              }), \",\", /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"TD\",\n                children: [upperFirst(translate(locale, fishingSpots[250].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.day')]\n              }), \",\", /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"TS\",\n                children: [upperFirst(translate(locale, fishingSpots[250].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.sunset')]\n              }), \",\", /*#__PURE__*/_jsxs(MenuItem, {\n                value: \"TN\",\n                children: [upperFirst(translate(locale, fishingSpots[250].placeName_sub, 'name_noArticle', 'name')), \" - \", t('time.night')]\n              })]\n            })\n          })]\n        })\n      }), /*#__PURE__*/_jsx(Grid, {\n        item: true,\n        xs: 12,\n        children: /*#__PURE__*/_jsx(NoSsr, {\n          children: /*#__PURE__*/_jsx(UpcomingVoyagesTable, {\n            now: now,\n            numRows: numRows,\n            filter: _filter,\n            onSelectRoute: onSelectRoute\n          })\n        })\n      })]\n    })\n  });\n};\n\nexport default UpcomingVoyages;","map":null,"metadata":{},"sourceType":"module"}